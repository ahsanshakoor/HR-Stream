{% extends "base.html" %}
{% load static %}
{% load accounts_tags %}
{% load widget_tweaks %}
{% block title %}Admin Dashboard {{ block.super }} {% endblock %}
{% block content %}


        <!-- Page Wrapper -->
        <div class="page-wrapper">

            <!-- Page Content -->
            <div class="content container-fluid">

                <!-- Page Header -->
                <div class="page-header">
                    <div class="row">
                        <div class="col-sm-12">
                            <h3 class="page-title">Welcome {{ user.get_full_name | title }}!</h3>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item active">Dashboard</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- /Page Header -->

                <div class="row">
                    <div class="col-md-6 col-sm-6 col-lg-6 col-xl-3">
                        <div class="card dash-widget">
                            <div class="card-body">
                                <span class="dash-widget-icon"><i class="fa fa-cubes"></i></span>
                                <div class="dash-widget-info">
                                    <h3>{{ projects }}</h3>
                                    <span>Projects</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-sm-6 col-lg-6 col-xl-3">
                        <div class="card dash-widget">
                            <div class="card-body">
                                <span class="dash-widget-icon"><i class="fa fa-usd"></i></span>
                                <div class="dash-widget-info">
                                    <h3>{{ clients }}</h3>
                                    <span>Clients</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-sm-6 col-lg-6 col-xl-3">
                        <div class="card dash-widget">
                            <div class="card-body">
                                <span class="dash-widget-icon"><i class="fa fa-diamond"></i></span>
                                <div class="dash-widget-info">
                                    <h3>{{ tasks }}</h3>
                                    <span>Tasks</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-sm-6 col-lg-6 col-xl-3">
                        <div class="card dash-widget">
                            <div class="card-body">
                                <span class="dash-widget-icon"><i class="fa fa-user"></i></span>
                                <div class="dash-widget-info">
                                    <h3>{{ employees }}</h3>
                                    <span>Employees</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                        <div class="card-group m-b-30">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between mb-3">
                                        <div>
                                            <span class="d-block">New Employees</span>
                                        </div>
                                        <div>
                                            <span class="text-success">+{{ new_employees_percentage }}%</span>
                                        </div>
                                    </div>
                                    <h3 class="mb-3">{{ new_employees }}</h3>
                                    <div class="progress mb-2" style="height: 5px;">
                                        <div class="progress-bar bg-primary" role="progressbar" style="width: {{ new_employees_percentage }}%;"
                                             aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <p class="mb-0">Overall Employees {{ employees }}</p>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>

                <!-- Statistics Widget -->
                <div class="row">
                    <div class="col-md-12 col-lg-12 col-xl-4 d-flex">
                        <div class="card flex-fill dash-statistics">
                            <div class="card-body">
                                <h5 class="card-title">Statistics</h5>
                                <div class="stats-list">
                                    <div class="stats-info">
                                        <p>Today Leave <strong>{{ today_leaves }}<small>/ {{ leaves.count }}</small></strong>
                                        </p>
                                        <div class="progress">
                                            <div class="progress-bar bg-primary" role="progressbar"
                                                 style="width: {{ today_leaves_percentage }}%"
                                                 aria-valuenow="{{ today_leaves_percentage }}" aria-valuemin="0"
                                                 aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                    <div class="stats-info">
                                        <p>Completed Projects <strong>{{ completed_projects }}
                                            <small>/ {{ projects }}</small></strong></p>
                                        <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar"
                                                 style="width: {{ completed_project_percentage }}%"
                                                 aria-valuenow="62" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-12 col-lg-6 col-xl-4 d-flex">
                        <div class="card flex-fill">
                            <div class="card-body">
                                <h4 class="card-title">Task Statistics</h4>
                                <div class="statistics">
                                    <div class="row">
                                        <div class="col-md-6 col-6 text-center">
                                            <div class="stats-box mb-4">
                                                <p>Total Tasks</p>
                                                <h3>{{ tasks }}</h3>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-6 text-center">
                                            <div class="stats-box mb-4">
                                                <p>Overdue Tasks</p>
                                                <h3>{{ overdue_tasks.count }}</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="progress mb-4">
                                    <div class="progress-bar bg-purple" role="progressbar"
                                         style="width: {{ completed_tasks_percentage }}%"
                                         aria-valuenow="30"
                                         aria-valuemin="0" aria-valuemax="100">{{ completed_tasks_percentage }}%
                                    </div>
                                    <div class="progress-bar bg-warning" role="progressbar"
                                         style="width: {{ in_progress_tasks_percentage }}%"
                                         aria-valuenow="18" aria-valuemin="0"
                                         aria-valuemax="100">{{ in_progress_tasks_percentage }}%
                                    </div>
                                    <div class="progress-bar bg-success" role="progressbar"
                                         style="width: {{ on_hold_tasks_percentage }}%"
                                         aria-valuenow="12" aria-valuemin="0"
                                         aria-valuemax="100">{{ on_hold_tasks_percentage }}%
                                    </div>
                                    <div class="progress-bar bg-danger" role="progressbar"
                                         style="width: {{ pending_tasks_percentage }}%"
                                         aria-valuenow="14"
                                         aria-valuemin="0" aria-valuemax="100">{{ pending_tasks_percentage }}%
                                    </div>
                                    <div class="progress-bar bg-info" role="progressbar"
                                         style="width: {{ under_review_tasks_percentage }}%"
                                         aria-valuenow="14"
                                         aria-valuemin="0" aria-valuemax="100">{{ under_review_tasks_percentage }}%
                                    </div>
                                </div>
                                <div>
                                    <p><i class="fa fa-dot-circle-o text-purple mr-2"></i>Completed Tasks <span
                                            class="float-right">{{ completed_tasks }}</span></p>
                                    <p><i class="fa fa-dot-circle-o text-warning mr-2"></i>Inprogress Tasks <span
                                            class="float-right">{{ in_progress_tasks }}</span></p>
                                    <p><i class="fa fa-dot-circle-o text-success mr-2"></i>On Hold Tasks <span
                                            class="float-right">{{ on_hold_tasks }}</span></p>
                                    <p><i class="fa fa-dot-circle-o text-danger mr-2"></i>Pending Tasks <span
                                            class="float-right">{{ pending_tasks }}</span></p>
                                    <p class="mb-0"><i class="fa fa-dot-circle-o text-info mr-2"></i>Review Tasks <span
                                            class="float-right">{{ under_review_tasks }}</span></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-12 col-lg-6 col-xl-4 d-flex">
                        <div class="card flex-fill">
                            <div class="card-body">
                                <h4 class="card-title">Today Absent <span
                                        class="badge bg-inverse-danger ml-2">{{ today_leave_request.count }}</span></h4>
                                {% for leave_request in today_leave_request %}
                                    <div class="leave-info-box">
                                        <div class="media align-items-center">
                                            <a href="{% url 'myprofile_detail' leave_request.employee.id %}"
                                              ><img  class="avatar" alt=""
                                                    {% if leave_request.employee.profile_pic %}
                                                                   src="{{ leave_request.employee.profile_pic.url }}" {% endif %}></a>
                                            <div class="media-body">
                                                <div class="text-sm my-0">{{ leave_request.employee.get_full_name }}</div>
                                            </div>
                                        </div>
                                        <div class="row align-items-center mt-3">
                                            <div class="col-6">
                                                <h6 class="mb-0">{{ leave_request.leave_from }}</h6>
                                                <span class="text-sm text-muted">Leave Date</span>
                                            </div>
                                            <div class="col-6 text-right">
                                                <span class="badge bg-inverse-danger">{{ leave_request.status }}</span>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                                {% if today_leave_request_count == '0' %}
                                    <div class="load-more text-center">
                                        <a class="text-dark" href="{% url 'leave' %}">Load More</a>
                                    </div>
                                {% endif %}

                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Statistics Widget -->

{#                <div class="row">#}
{#                    <div class="col-md-6 d-flex">#}
{#                        <div class="card card-table flex-fill">#}
{#                            <div class="card-header">#}
{#                                <h3 class="card-title mb-0">Invoices</h3>#}
{#                            </div>#}
{#                            <div class="card-body">#}
{#                                <div class="table-responsive">#}
{#                                    <table class="table table-nowrap custom-table mb-0">#}
{#                                        <thead>#}
{#                                        <tr>#}
{#                                            <th>Invoice ID</th>#}
{#                                            <th>Client</th>#}
{#                                            <th>Due Date</th>#}
{#                                            <th>Total</th>#}
{#                                            <th>Status</th>#}
{#                                        </tr>#}
{#                                        </thead>#}
{#                                        <tbody>#}
{#                                        <tr>#}
{#                                            <td><a href="invoice-view.html">#INV-0001</a></td>#}
{#                                            <td>#}
{#                                                <h2><a href="index.html#">Global Technologies</a></h2>#}
{#                                            </td>#}
{#                                            <td>11 Mar 2019</td>#}
{#                                            <td>$380</td>#}
{#                                            <td>#}
{#                                                <span class="badge bg-inverse-warning">Partially Paid</span>#}
{#                                            </td>#}
{#                                        </tr>#}
{#                                        <tr>#}
{#                                            <td><a href="invoice-view.html">#INV-0002</a></td>#}
{#                                            <td>#}
{#                                                <h2><a href="index.html#">Delta Infotech</a></h2>#}
{#                                            </td>#}
{#                                            <td>8 Feb 2019</td>#}
{#                                            <td>$500</td>#}
{#                                            <td>#}
{#                                                <span class="badge bg-inverse-success">Paid</span>#}
{#                                            </td>#}
{#                                        </tr>#}
{#                                        <tr>#}
{#                                            <td><a href="invoice-view.html">#INV-0003</a></td>#}
{#                                            <td>#}
{#                                                <h2><a href="index.html#">Cream Inc</a></h2>#}
{#                                            </td>#}
{#                                            <td>23 Jan 2019</td>#}
{#                                            <td>$60</td>#}
{#                                            <td>#}
{#                                                <span class="badge bg-inverse-danger">Unpaid</span>#}
{#                                            </td>#}
{#                                        </tr>#}
{#                                        </tbody>#}
{#                                    </table>#}
{#                                </div>#}
{#                            </div>#}
{#                            <div class="card-footer">#}
{#                                <a href="invoices.html">View all invoices</a>#}
{#                            </div>#}
{#                        </div>#}
{#                    </div>#}
{#                    <div class="col-md-6 d-flex">#}
{#                        <div class="card card-table flex-fill">#}
{#                            <div class="card-header">#}
{#                                <h3 class="card-title mb-0">Payments</h3>#}
{#                            </div>#}
{#                            <div class="card-body">#}
{#                                <div class="table-responsive">#}
{#                                    <table class="table custom-table table-nowrap mb-0">#}
{#                                        <thead>#}
{#                                        <tr>#}
{#                                            <th>Invoice ID</th>#}
{#                                            <th>Client</th>#}
{#                                            <th>Payment Type</th>#}
{#                                            <th>Paid Date</th>#}
{#                                            <th>Paid Amount</th>#}
{#                                        </tr>#}
{#                                        </thead>#}
{#                                        <tbody>#}
{#                                        <tr>#}
{#                                            <td><a href="invoice-view.html">#INV-0001</a></td>#}
{#                                            <td>#}
{#                                                <h2><a href="index.html#">Global Technologies</a></h2>#}
{#                                            </td>#}
{#                                            <td>Paypal</td>#}
{#                                            <td>11 Mar 2019</td>#}
{#                                            <td>$380</td>#}
{#                                        </tr>#}
{#                                        <tr>#}
{#                                            <td><a href="invoice-view.html">#INV-0002</a></td>#}
{#                                            <td>#}
{#                                                <h2><a href="index.html#">Delta Infotech</a></h2>#}
{#                                            </td>#}
{#                                            <td>Paypal</td>#}
{#                                            <td>8 Feb 2019</td>#}
{#                                            <td>$500</td>#}
{#                                        </tr>#}
{#                                        <tr>#}
{#                                            <td><a href="invoice-view.html">#INV-0003</a></td>#}
{#                                            <td>#}
{#                                                <h2><a href="index.html#">Cream Inc</a></h2>#}
{#                                            </td>#}
{#                                            <td>Paypal</td>#}
{#                                            <td>23 Jan 2019</td>#}
{#                                            <td>$60</td>#}
{#                                        </tr>#}
{#                                        </tbody>#}
{#                                    </table>#}
{#                                </div>#}
{#                            </div>#}
{#                            <div class="card-footer">#}
{#                                <a href="payments.html">View all payments</a>#}
{#                            </div>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}

                <div class="row">
                    <div class="col-md-6 d-flex">
                        <div class="card card-table flex-fill">
                            <div class="card-header">
                                <h3 class="card-title mb-0">Clients</h3>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table custom-table mb-0">
                                        <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Email</th>
{#                                            <th>Status</th>#}
{#                                            <th class="text-right">Action</th>#}
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for client in client_list %}

                                            <tr>
                                                <td>
                                                    <h2 class="table-avatar">
                                                        <a href="javascript:void(0)" >
                                                            <img class="avatar" alt=""
                                                                {% if client.profile_pic %}
                                                                 src="{{ client.profile_pic.url }}"
                                                                {% endif %}>
                                                        </a>
                                                        <a href="{% url 'clientprofile_detail' client.id %}">{{ client.get_full_name }}
                                                            <span>{{ client.role.last }}</span></a>
                                                    </h2>
                                                </td>
                                                <td>{{ client.email }}</td>
{#                                                <td>#}
{#                                                    <div class="dropdown action-label">#}
{#                                                        <a class="btn btn-white btn-sm btn-rounded dropdown-toggle"#}
{#                                                           href="javascript:void(0)" data-toggle="dropdown"#}
{#                                                           aria-expanded="false">#}
{#                                                            <i class="fa fa-dot-circle-o text-success"></i> Active#}
{#                                                        </a>#}
{#                                                        <div class="dropdown-menu dropdown-menu-right">#}
{#                                                            <a class="dropdown-item" href="index.html#"><i#}
{#                                                                    class="fa fa-dot-circle-o text-success"></i> Active</a>#}
{#                                                            <a class="dropdown-item" href="index.html#"><i#}
{#                                                                    class="fa fa-dot-circle-o text-danger"></i> Inactive</a>#}
{#                                                        </div>#}
{#                                                    </div>#}
{#                                                </td>#}
{#                                                <td class="text-right">#}
{#                                                    <div class="dropdown dropdown-action">#}
{#                                                        <a href="index.html#" class="action-icon dropdown-toggle"#}
{#                                                           data-toggle="dropdown" aria-expanded="false"><i#}
{#                                                                class="material-icons">more_vert</i></a>#}
{#                                                        <div class="dropdown-menu dropdown-menu-right">#}
{#                                                            <a class="dropdown-item" href="javascript:void(0)"><i#}
{#                                                                    class="fa fa-pencil m-r-5"></i> Edit</a>#}
{#                                                            <a class="dropdown-item" href="javascript:void(0)"><i#}
{#                                                                    class="fa fa-trash-o m-r-5"></i> Delete</a>#}
{#                                                        </div>#}
{#                                                    </div>#}
{#                                                </td>#}
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="card-footer">
                                {% if clients %}
                                    <a href="{% url 'view_clients' %}">View all clients</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 d-flex">
                        <div class="card card-table flex-fill">
                            <div class="card-header">
                                <h3 class="card-title mb-0">Recent Projects</h3>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table custom-table mb-0">
                                        <thead>
                                        <tr>
                                            <th>Project Name</th>
                                            <th>Progress</th>
                                            <th class="text-right">Action</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for project in project_list %}
                                            <tr>
                                                <td>
                                                    <h2><a href="javascript:void(0);">{{ project.name }}</a></h2>
{#                                                    <small class="block text-ellipsis">#}
{#                                                        <span>1</span> <span class="text-muted">open tasks, </span>#}
{#                                                        <span>9</span> <span class="text-muted">tasks completed</span>#}
{#                                                    </small>#}
                                                </td>
                                                <td>
                                                    <div class="progress progress-xs progress-striped">
                                                        <div class="progress-bar" role="progressbar"
                                                             data-toggle="tooltip"
                                                             title="{{ project.progress }}"
                                                             style="width: {{ project.progress }}"></div>
                                                    </div>
                                                </td>
                                                <td class="text-right">
                                                    <div class="dropdown dropdown-action">
                                                        <a href="javascript:void(0)" class="action-icon dropdown-toggle"
                                                           data-toggle="dropdown" aria-expanded="false"><i
                                                                class="material-icons">more_vert</i></a>
                                                        <div class="dropdown-menu dropdown-menu-right">
                                                            <a id="ProjectEdit"
                                                               data-ProjectEdit="{% url 'project_edit' pk=project.id type='dashboard' %}"
                                                               class="dropdown-item" href="javascript:void(0)"><i
                                                                    class="fa fa-pencil m-r-5"></i> Edit</a>
                                                            <a class="dropdown-item" href="javascript:void(0)"
                                                               data-toggle="modal"
                                                               data-target="#delete_project-{{ project.id }}"><i
                                                                    class="fa fa-trash-o m-r-5"></i> Delete</a>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        {% endfor %}

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="card-footer">
                                {% if projects %}
                                    <a href="{% url 'projects' %}">View all projects</a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!-- /Page Content -->
            <!-- Edit Project Modal -->

            <div id="edit_project" class="modal custom-modal fade" role="dialog">
                <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Edit Project</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div id="project-edit-form" class="modal-body">

                        </div>
                    </div>
                </div>
            </div>

            <!-- /Edit Project Modal -->

            <!-- Delete Project Modal -->
            {% for project in project_list %}
                <div class="modal custom-modal fade" id="delete_project-{{ project.id }}" role="dialog">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-body">
                                <div class="form-header">
                                    <h3>Delete Project</h3>
                                    <p>Are you sure want to delete?</p>
                                </div>
                                <div class="modal-btn delete-action">
                                    <div class="row">
                                        <div class="col-6">
                                            <a href="{% url 'delete_project' pk=project.id %}"
                                               class="btn btn-primary continue-btn">Delete</a>
                                        </div>
                                        <div class="col-6">
                                            <a href="javascript:void(0);" data-dismiss="modal"
                                               class="btn btn-primary cancel-btn">Cancel</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
            <!-- /Delete Project Modal -->

        </div>
        <!-- /Page Wrapper -->

{% endblock %}